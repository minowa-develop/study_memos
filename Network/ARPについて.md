# ARPについて

## ARPヘッダと役割の関係

項目|ARP要求|ARP応答|重複IP検知|キャッシュ更新
-|-|-|-|-
Src MAC|要求|対象|要求|要求
Src IP|要求|対象|**0...**|**要求**
Tgt MAC|0...|**要求**|0...|0...
Tgt IP|対象|要求|検知(要求)|**要求**

### 判定方法

- Src IP == 0...: 重複IP検知
- Src IP == Tgt IP: キャッシュ更新
- Tgt MAC != 0...: ARP応答

## ARP受信時の挙動

1. ARP要求IPがARPキャッシュにあれば要求IP、MACを更新(全ホスト)
1. ARP要求IPがARPキャッシュになければ、要求IP、MACを追加(対象ホスト)
1. ARPパケットが要求なら応答パケットを作成し、送信する
